chrome.runtime.onMessage.addListener(((e,t,n)=>{"teacherList"===e.type&&async function(e,t){let n=[];for(let r=0;r<e.length;r++){const a={text:e[r]};try{const e=await fetch("https://v0-proxy-server-git-main-adeebismails-projects.vercel.app/api/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:'\n    query NewSearch($text: String!) {\n      newSearch {\n        teachers(query: { text: $text, schoolID: "U2Nob29sLTEwMDM=" }) {\n          edges {\n            cursor\n            node {\n              id\n              firstName\n              lastName\n              avgDifficulty\n              avgRating\n              department\n              legacyId\n              numRatings\n              wouldTakeAgainPercent\n              courseCodes {\n                        courseName\n                }\n            }\n          }\n        }\n      }\n    }\n  ',variables:a})});let r=(await e.json()).data.newSearch.teachers.edges;for(let e=0;e<r.length;e++){courses=r[e].node.courseCodes;for(let a=0;a<courses.length;a++)if(courses[a].courseName.startsWith(t)){n.push(r[e]);break}}}catch(e){console.error("GraphQL Error:",e)}}return n}(e.data,e.departmentCode).then((e=>{chrome.tabs.query({active:!0,currentWindow:!0},(t=>{chrome.tabs.sendMessage(t[0].id,{type:"teacherData",data:e})}))}))})),chrome.webNavigation.onHistoryStateUpdated.addListener((e=>{e.url.includes("courses")&&chrome.scripting.executeScript({target:{tabId:e.tabId},files:["src/content.js"]})}),{url:[{hostContains:"tamu.collegescheduler.com"}]});